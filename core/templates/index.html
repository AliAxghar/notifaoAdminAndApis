{% extends "layouts/base.html" %}

{% block title %} Dashboard {% endblock %} 

<!-- Specific CSS goes HERE -->
{% block stylesheets %}
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
<!-- <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script> -->
<style>
    #my-table_length, #my-table_info{
        display: none;
    }
    #my-table_paginate ul{
        margin-bottom: 0rem;
    }
    .table-responsive {
        overflow-x: hidden;
    }
    input.form-control-sm {
        border: none!important;
        background: #ffffff;
        padding: 3px 5px!important;
        font-size: 13px!important;
    }
    .form-control-sm:focus {
        color: #495057;
        background-color: #fff!important;
    }
    .page-link {
        padding: 0.3rem .75rem!important;
    }
    .page-item.active .page-link {
        color: #fff!important;
        background-color: #274a5d!important;
        border-color: #274a5d!important;
    }
    #my-table_filter{
        float: right!important;
        display: none!important;
    }
    #my-table_paginate{
        float: right!important;
        display: none!important;
    }
</style>
{% endblock stylesheets %}

{% block content %}

    <div class="pcoded-content">
        <div class="pcoded-inner-content">
            <!-- [ breadcrumb ] start -->

            <!-- [ breadcrumb ] end -->
            <div class="main-body">
                <div class="page-wrapper">
                    <!-- [ Main Content ] start -->
                    <div class="row top-row">
                        <div class="col-md-6 col-sm-12">
                            <!-- Search form -->
                            <form>
                                <div class="form-group has-search">
                                    <span class="fa fa-search form-control-feedback"></span>
                                    <input type="text" class="form-control" placeholder="Search">
                                </div>
                            </form>
                        </div>
                        <div class="col-md-6 col-sm-12">
                            <div class="top-right mt-1">
                                <ul>
                                    <li class="mr-2">
                                        <!-- <span class="bell-btn"><img class="bell-icon" src="/static/assets/images/bell.png" alt=""><span class="notif">5</span></span> -->
                                        {% if request.user.profile_pic %}
                                        <img class="top-r-img" src="{{request.user.profile_pic.url}}" alt="Profile image">
                                        {% else %}
                                        <img class="top-r-img" src="/static/assets/images/black1.png" alt="Profile image">
                                        {% endif %}
                                    </li>
                                    
                                    <li class="">
                                        <span class="intr" >
                                            <div class="intr11">Hi {{ request.user.name }}</div>
                                            <div class="intr11">{{ request.user.email }}</div>
                                        </span>
                                    </li>
                                    <li>
                                        <a class="nav-link1 top-drop" href="#" data-toggle="dropdown" aria-expanded="false">
                                            <i class="feather icon-chevron-down"></i>
                                            <div class="dropdown-menu dropdown-menu-right navbar-dropdown ml-5" aria-labelledby="UserDropdown">
                                                <!-- <div class="dropdown-header text-center">
                                                    {% if request.user.profile_pic %}
                                                    <img class="top-r-img1" src="{{request.user.profile_pic.url}}" alt="Profile image">
                                                    {% else %}
                                                    <img class="top-r-img1" src="/static/assets/images/black1.png" alt="Profile image">
                                                    {% endif %}
                                                    <p class="mb-1 mt-3 font-weight-semibold">
                                                    {{ request.user.user }}
                                                    </p>
                                                    <p class="font-weight-light text-muted mb-0 p-b-e">
                                                    {{ request.user.email }}
                                                    </p>
                                                </div> -->
                                                <a href="{% url 'update_profile' request.user.id %}" class="dropdown-item item1">My Profile<i class="dropdown-item-icon ti-dashboard"></i></a>
                                                <!-- <a href="#" class="dropdown-item item1">Messages <span class="badge badge-pill badge-danger">2</span><i class="dropdown-item-icon ti-comment-alt"></i></a> -->
                                                <a href="{% url 'logout' %}" class="dropdown-item item1">Sign Out<i class="dropdown-item-icon ti-power-off"></i></a>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <hr class="hr-top">
                    {% if request.user.is_superuser %}
                    <div class="row">
                        <!-- <div class="col-md-1"></div> -->
                        <div class="col-md-12">
                            <h4 class="title1">Dashboard</h4>
                            <div class="row pt-2">
                                <div class="col-md-6">
                                    <h5 class="title2 pb-3">Trafic Statistics</h5>
                                </div>
                                <div class="col-md-6">
                                    <!-- <form action="" style="margin: 0; padding: 0;" method="post" role="form">
                                        {% csrf_token %}
                                        <span class="form-h-1">
                                            <span class="date-label">Select Date:</span>
                                            <input type="date" name="dates" class="date-input" id="date-input" data-date="" data-date-format="DD MMMM YYYY" value="2020-05-20">
                                            <input class="btn-c" id="submit"  type="submit" value="Show All"/>
                                        </span>
                                    </form> -->
                                </div>
                            </div>
                            <!-- <div class="row">
                                <div class="col-md-6">
                                    <div class="card card-l">
                                        <div class="row">
                                            <div class="col-2 pt-2">
                                                <img src="/static/assets/images/bell.png" alt="">
                                            </div>
                                            <div class="col-5 pt-2">
                                                <span class="card-l-s">
                                                    <h5 class="pt-1">Total Notifications</h5>
                                                    <h4>{{request.user.total_notifications_sent}}</h4>
                                                </span>
                                            </div>
                                            <div class="col-5">
                                                <!-- <canvas id="myChart" class="" style="height: 20px;width: 50px;"></canvas> -->

                                                <div id="chart_div1" ></div>

                                            </div>
                                        </div>
                                        
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card card-l">
                                        <div class="row">
                                            <div class="col-2 pt-2">
                                                <img src="/static/assets/images/user1.png" alt="">
                                            </div>
                                            <div class="col-5 pt-2">
                                                <span class="card-l-s">
                                                    <h5 class="pt-1">Total Users</h5>
                                                    <h4>{{total_users}}</h4>
                                                </span>
                                            </div>
                                            <div class="col-5">

                                                <!-- <canvas id="myChart1" style="height: 20px;width: 50px;"></canvas> -->

                                                <div id="chart_div" ></div>

                                            </div>
                                        </div>
                                        
                                    </div>
                                </div>
                                
                            </div> -->
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card card-l-d">
                                        <div class="row pb-1">
                                            <div class="col-6">
                                                <h5>Notifications</h5>
                                            </div>
                                            <div class="col-6">

                                                <a href="../../notification.html">See all notifications</a>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-12">
                                                {% if a_notifications %}
                                                {% for notification in a_notifications %}
                                                <a href="{% url 'singleNotification' notification.id %}">
                                                    <div class="card card-cl mb-1">
                                                        <div class="row">
                                                            <div class="col-2">
                                                                <img src="/static/assets/images/logo-thumb.png" alt="">
                                                            </div>
                                                            <div class="col-8 pt-1">
                                                                <p class="noti-p">{{notification.description|slice:':80'}}</p>
                                                            </div>
                                                            <div class="col-2 cl">
                                                                <img class="arrow mt-1" src="/static/assets/images/right-arrow.png" alt="">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </a>
                                                {% endfor %}
                                                {% else %}
                                                <p class="text-center p-3">No Notifications</p>
                                                {% endif %}
                                            </div>
                                        </div>

                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card card-l-d">
                                        <div class="row">

                                            <!-- <div class="col-5">
                                                <h5>Users</h5>
                                            </div> -->
                                            <!-- <div class="col-7">
                                                <form class="form-inline md-form form-sm mt-0">
                                                    <span class="search-btn2"><i class="feather icon-search pt-1"></i>
                                                    <input type="search" class="form-control form-control-sm-1" placeholder="Search" aria-controls="my-table"></span>
                                                </form>
                                            </div> -->
                                        </div>
                                        <div class="row">
                                            <div class="col-12">
                                                <div class="card-block table-border-style pt-0 pb-0">
                                                    <div class="table-responsive">
                                                        <h5>Users</h5>
                                                        <br>
                                                        <table id="my-table" class="table table-striped table-bordered" style="width:100%">
                                                            <thead>
                                                                <tr>
                                                                    <th>Name</th>
                                                                    <th>Phone</th>
                                                                    <th>Email</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                {% for userapp in lasUsers %}
                                                                <tr>
                                                                    <td>{{userapp.user_id.name}}</td>
                                                                    <td>{{userapp.user_id.phone}}</td>
                                                                    <td>{{userapp.user_id.email}}</td>
                                                                </tr>
                                                                {% endfor %}
                                                                <!-- <tr>
                                                                    <td class="td-1">Ali</td>
                                                                    <td>+923224277699</td>
                                                                    <td>Ali@gmail.com</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="td-1">Ali</td>
                                                                    <td>+923224277699</td>
                                                                    <td>Ali@gmail.com</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="td-1">Ali</td>
                                                                    <td>+923224277699</td>
                                                                    <td>Ali@gmail.com</td>
                                                                </tr> -->
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- <div class="col-md-1">
                            <div class="card right-c">
                                <div class="card card-i">
                                    <h4 class="pt-1">Plan Usage</h4>
                                    <div id="donut_chart" style="height:200px"></div>
                                    <div class="row text-center">
                                        <div class="col-6 b-clr"><span class="Unused mr-1 dot"></span>Unused</div>
                                        <div class="col-6 b-clr"><span class="planused mr-1 dot1"></span>Plan Used</div>
                                    </div>
                                    <p class="card-p pt-3">You have used <span style="color: black;">{{total_used_notification}}%</span> of your actual plan</p>
                                </div>
                                <div class="right-c-d">
                                    <h6>Limits</h6>
                                    <p >You have no limit on your account. New plan package will renew automatically. You have 3000 notification left <a href="../../my-plan.html">Buy More</a></p>
                                    <h6 class="pt-1">Total users connected</h6>
                                    <h3 class="pt-1">{{total_users}}</h3>
                                    <p class="pt-1"> You've {{total_users}} users connected tou your app. How to <a href="#">Convince users</a> to install our app</p>
                                </div>
                            </div>
                        </div>                  -->
                    </div>
                    {% else %}
                        {% if invoice_item %}
                        <div class="row">
                            <div class="col-md-9">
                                <h4 class="title1">Dashboard</h4>
                                <div class="row pt-2">
                                    <div class="col-md-6">
                                        <h5 class="title2 pb-3">Trafic Statistics</h5>
                                    </div>
                                    <div class="col-md-6">
                                        <form action="" style="margin: 0; padding: 0;" method="post" role="form">
                                            {% csrf_token %}
                                            <span class="form-h-1">
                                                <span class="date-label">Select Date:</span>
                                                <input type="date" name="dates" class="date-input" id="date-input" data-date="" data-date-format="DD MMMM YYYY" value="2020-05-20">
                                                <input class="btn-c" id="submit"  type="submit" value="Show All"/>
                                            </span>
                                        </form>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="card card-l">
                                            <div class="row">
                                                <div class="col-2 pt-2">
                                                    <img src="/static/assets/images/bell.png" alt="">
                                                </div>
                                                <div class="col-5 pt-2">
                                                    <span class="card-l-s">
                                                        <h5 class="pt-1">Total Notifications</h5>
                                                        <h4>{{request.user.total_notifications_sent}}</h4>
                                                    </span>
                                                </div>
                                                <div class="col-5">
                                                    <!-- <canvas id="myChart" class="" style="height: 20px;width: 50px;"></canvas> -->
                                                    <div id="chart_div1" ></div>
                                                </div>
                                            </div>
                                            
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card card-l">
                                            <div class="row">
                                                <div class="col-2 pt-2">
                                                    <img src="/static/assets/images/user1.png" alt="">
                                                </div>
                                                <div class="col-5 pt-2">
                                                    <span class="card-l-s">
                                                        <h5 class="pt-1">Total Users</h5>
                                                        <h4>{{total_users}}</h4>
                                                    </span>
                                                </div>
                                                <div class="col-5">
                                                    <!-- <canvas id="myChart1" style="height: 20px;width: 50px;"></canvas> -->
                                                    <div id="chart_div" ></div>
                                                </div>
                                            </div>
                                            
                                        </div>
                                    </div>
                                    
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="card card-l-d">
                                            <div class="row pb-1">
                                                <div class="col-6">
                                                    <h5>Notifications</h5>
                                                </div>
                                                <div class="col-6">
                                                    <a href="../../notification.html">See all notifications</a>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    {% if notifications %}
                                                    {% for notification in notifications %}
                                                    <a href="{% url 'singleNotification' notification.id %}">
                                                        <div class="card card-cl mb-1">
                                                            <div class="row">
                                                                <div class="col-2">
                                                                    <img src="/static/assets/images/logo-thumb.png" alt="">
                                                                </div>
                                                                <div class="col-8 pt-1">
                                                                    <p class="noti-p">{{notification.description|slice:':80'}}</p>
                                                                </div>
                                                                <div class="col-2 cl">
                                                                    <img class="arrow mt-1" src="/static/assets/images/right-arrow.png" alt="">
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </a>
                                                    {% endfor %}
                                                    {% else %}
                                                    <p class="text-center p-3">No Notifications</p>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card card-l-d">
                                            <div class="row">
                                                <!-- <div class="col-5">
                                                    <h5>Users</h5>
                                                </div> -->
                                                <!-- <div class="col-7">
                                                    <form class="form-inline md-form form-sm mt-0">
                                                        <span class="search-btn2"><i class="feather icon-search pt-1"></i>
                                                        <input type="search" class="form-control form-control-sm-1" placeholder="Search" aria-controls="my-table"></span>
                                                    </form>
                                                </div> -->
                                            </div>
                                            <div class="row">
                                                <div class="col-12">
                                                    <div class="card-block table-border-style pt-0 pb-0">
                                                        <div class="table-responsive">
                                                            <h5>Users</h5>
                                                            <br>
                                                            <table id="my-table" class="table table-striped table-bordered" style="width:100%">
                                                                <thead>
                                                                    <tr>
                                                                        <th>Name</th>
                                                                        <th>Phone</th>
                                                                        <th>Email</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    {% for userapp in lasUsers %}
                                                                    <tr>
                                                                        <td>{{userapp.user_id.name}}</td>
                                                                        <td>{{userapp.user_id.phone}}</td>
                                                                        <td>{{userapp.user_id.email}}</td>
                                                                    </tr>
                                                                    {% endfor %}
                                                                    <!-- <tr>
                                                                        <td class="td-1">Ali</td>
                                                                        <td>+923224277699</td>
                                                                        <td>Ali@gmail.com</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="td-1">Ali</td>
                                                                        <td>+923224277699</td>
                                                                        <td>Ali@gmail.com</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="td-1">Ali</td>
                                                                        <td>+923224277699</td>
                                                                        <td>Ali@gmail.com</td>
                                                                    </tr> -->
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card right-c">
                                    <div class="card card-i">
                                        <h4 class="pt-1">Plan Usage</h4>
                                        <div id="donut_chart" style="height:200px"></div>
                                        <div class="row text-center">
                                            <div class="col-6 b-clr"><span class="Unused mr-1 dot"></span>Unused</div>
                                            <div class="col-6 b-clr"><span class="planused mr-1 dot1"></span>Plan Used</div>
                                        </div>
                                        <p class="card-p pt-3">You have used <span style="color: black;">{{total_used_notification}}%</span> of your actual plan</p>
                                    </div>
                                    <div class="right-c-d">
                                        <h6>Limits</h6>
                                        <p >You have no limit on your account. New plan package will renew automatically. You have 3000 notification left <a href="../../my-plan.html">Buy More</a></p>
                                        <h6 class="pt-1">Total users connected</h6>
                                        <h3 class="pt-1">{{total_users}}</h3>
                                        <p class="pt-1"> You've {{total_users}} users connected tou your app. How to <a href="#">Convince users</a> to install our app</p>
                                    </div>
                                </div>
                            </div>                 
                        </div>
                        {% else %}
                        <div class="row">
                            <div class="col-md-12">
                                <h4 class="title1">Dashboard</h4>
                                <div class="row pt-2">
                                    <div class="col-md-6">
                                        <h5 class="title2 pb-3">Trafic Statistics</h5>
                                    </div>
                                    <div class="col-md-6">
                                        <form action="" style="margin: 0; padding: 0;" method="post" role="form">
                                            {% csrf_token %}
                                            <span class="form-h-1">
                                                <span class="date-label">Select Date:</span>
                                                <input type="date" name="dates" class="date-input" id="date-input" data-date="" data-date-format="DD MMMM YYYY" value="2020-05-20">
                                                <input class="btn-c" id="submit"  type="submit" value="Show All"/>
                                            </span>
                                        </form>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="card card-l">
                                            <div class="row">
                                                <div class="col-2 pt-2">
                                                    <img src="/static/assets/images/bell.png" alt="">
                                                </div>
                                                <div class="col-5 pt-2">
                                                    <span class="card-l-s">
                                                        <h5 class="pt-1">Total Notifications</h5>
                                                        <h4>{{request.user.total_notifications_sent}}</h4>
                                                    </span>
                                                </div>
                                                <div class="col-5">
                                                    <!-- <canvas id="myChart" class="" style="height: 20px;width: 50px;"></canvas> -->
                                                    <div id="chart_div1" ></div>
                                                </div>
                                            </div>
                                            
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card card-l">
                                            <div class="row">
                                                <div class="col-2 pt-2">
                                                    <img src="/static/assets/images/user1.png" alt="">
                                                </div>
                                                <div class="col-5 pt-2">
                                                    <span class="card-l-s">
                                                        <h5 class="pt-1">Total Users</h5>
                                                        <h4>{{total_users}}</h4>
                                                    </span>
                                                </div>
                                                <div class="col-5">
                                                    <!-- <canvas id="myChart1" style="height: 20px;width: 50px;"></canvas> -->
                                                    <div id="chart_div" ></div>
                                                </div>
                                            </div>
                                            
                                        </div>
                                    </div>
                                    
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="card card-l-d">
                                            <div class="row pb-1">
                                                <div class="col-6">
                                                    <h5>Notifications</h5>
                                                </div>
                                                <div class="col-6">
                                                    <a href="../../notification.html">See all notifications</a>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    {% if notifications %}
                                                    {% for notification in notifications %}
                                                    <a href="{% url 'singleNotification' notification.id %}">
                                                        <div class="card card-cl mb-1">
                                                            <div class="row">
                                                                <div class="col-2">
                                                                    <img src="/static/assets/images/logo-thumb.png" alt="">
                                                                </div>
                                                                <div class="col-8 pt-1">
                                                                    <p class="noti-p">{{notification.description|slice:':80'}}</p>
                                                                </div>
                                                                <div class="col-2 cl">
                                                                    <img class="arrow mt-1" src="/static/assets/images/right-arrow.png" alt="">
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </a>
                                                    {% endfor %}
                                                    {% else %}
                                                    <p class="text-center p-3">No Notification</p>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card card-l-d">
                                            <div class="row">
                                                <!-- <div class="col-5">
                                                    <h5>Users</h5>
                                                </div> -->
                                                <!-- <div class="col-7">
                                                    <form class="form-inline md-form form-sm mt-0">
                                                        <span class="search-btn2"><i class="feather icon-search pt-1"></i>
                                                        <input type="search" class="form-control form-control-sm-1" placeholder="Search" aria-controls="my-table"></span>
                                                    </form>
                                                </div> -->
                                            </div>
                                            <div class="row">
                                                <div class="col-12">
                                                    <div class="card-block table-border-style pt-0 pb-0">
                                                        <div class="table-responsive">
                                                            <h5>Users</h5>
                                                            <br>
                                                            <table id="my-table" class="table table-striped table-bordered" style="width:100%">
                                                                <thead>
                                                                    <tr>
                                                                        <th>Name</th>
                                                                        <th>Phone</th>
                                                                        <th>Email</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    {% for userapp in lasUsers %}
                                                                    <tr>
                                                                        <td>{{userapp.user_id.name}}</td>
                                                                        <td>{{userapp.user_id.phone}}</td>
                                                                        <td>{{userapp.user_id.email}}</td>
                                                                    </tr>
                                                                    {% endfor %}
                                                                    <!-- <tr>
                                                                        <td class="td-1">Ali</td>
                                                                        <td>+923224277699</td>
                                                                        <td>Ali@gmail.com</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="td-1">Ali</td>
                                                                        <td>+923224277699</td>
                                                                        <td>Ali@gmail.com</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="td-1">Ali</td>
                                                                        <td>+923224277699</td>
                                                                        <td>Ali@gmail.com</td>
                                                                    </tr> -->
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- <div class="col-md-3">
                                <div class="card right-c">
                                    <div class="card card-i">
                                        <h4 class="pt-1">Plan Usage</h4>
                                        <div id="donut_chart" style="height:200px"></div>
                                        <div class="row text-center">
                                            <div class="col-6 b-clr"><span class="Unused mr-1 dot"></span>Unused</div>
                                            <div class="col-6 b-clr"><span class="planused mr-1 dot1"></span>Plan Used</div>
                                        </div>
                                        <p class="card-p pt-3">You have used <span style="color: black;">{{total_used_notification}}%</span> of your actual plan</p>
                                    </div>
                                    <div class="right-c-d">
                                        <h6>Limits</h6>
                                        <p >You have no limit on your account. New plan package will renew automatically. You have 3000 notification left <a href="../../my-plan.html">Buy More</a></p>
                                        <h6 class="pt-1">Total users connected</h6>
                                        <h3 class="pt-1">{{total_users}}</h3>
                                        <p class="pt-1"> You've {{total_users}} users connected tou your app. How to <a href="#">Convince users</a> to install our app</p>
                                    </div>
                                </div>
                            </div>                  -->
                        </div>
                        {% endif %}
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- {{total_noti_graph_list}} -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

<script type="text/javascript">
    array_data = {{lists|safe}};
    array_data1 = {{total_noti_graph_list|safe}};
    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);
    function drawChart() {
        var noti_graph_list = [['Date', 'Notifications'],]
        array_data1.slice().reverse().forEach(function(entry) {
            noti_graph_list.push(entry);
        });
        var user_graph_list = [['Date', 'Users'],]
        array_data.slice().reverse().forEach(function(entry) {
            user_graph_list.push(entry);
        });
        var data1 = google.visualization.arrayToDataTable(noti_graph_list);
        var data = google.visualization.arrayToDataTable(user_graph_list);
        var options = {
            backgroundColor: {
                fill: '#fff0',
                fillOpacity: 0
            },
            height:65,
            vAxis:{
            baselineColor: '#fff',
            gridlineColor: '#fff',
            textPosition: 'none'
            },
            hAxis: { textPosition: 'none',
            display:false,
            },
            curveType: 'function',
            legend: { position: 'none' }
        };

        var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
        var chart1 = new google.visualization.LineChart(document.getElementById('chart_div1'));
        chart.draw(data, options);
        chart1.draw(data1, options);
        
    }
  </script>
  <!-- <script type="text/javascript">
    array_data1 = {{total_noti_graph_list|safe}};
    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);
    function drawChart() {
        
        // var data = google.visualization.arrayToDataTable(
        //     {{ lists|safe }}
        // );
        var data1 = google.visualization.arrayToDataTable([
            ['Date', 'Notifications'],
            array_data1[11],
            array_data1[10],
            array_data1[9],
            array_data1[8],
            array_data1[7],
            array_data1[6],
            array_data1[5],
            array_data1[4],
            array_data1[3],
            array_data1[2],
            array_data1[1],
            array_data1[0]
        ]);
        var options = {
            backgroundColor: {
                fill: '#fff0',
                fillOpacity: 0
            },
            height:65,
            vAxis:{
            baselineColor: '#fff',
            gridlineColor: '#fff',
            textPosition: 'none'
            },
            hAxis: { textPosition: 'none',
            display:false,
            },
            curveType: 'function',
            legend: { position: 'none' }
        };

        var chart1 = new google.visualization.LineChart(document.getElementById('chart_div1'));
        chart1.draw(data1, options);
        
    }
  </script> -->

    <script>
        $("input").on("change", function() {
            this.setAttribute(
                "data-date",
                moment(this.value, "YYYY-MM-DD")
                .format( this.getAttribute("data-date-format") )
            )
        }).trigger("change")
    </script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.6/Chart.bundle.min.js"></script>

    <script>
        (function () {
            var $, MyMorris;

            MyMorris = window.MyMorris = {};
            $ = jQuery;

            MyMorris = Object.create(Morris);

            MyMorris.Donut.prototype.select = function (idx) {
                var row, s, segment, _i, _len, _ref, _fill_color; // ADDED _fill_color
                _ref = this.segments;
                for (_i = 0, _len = _ref.length; _i < _len; _i++) {
                    s = _ref[_i];
                    s.deselect();
                }
                segment = this.segments[idx];
                segment.select();
                row = this.data[idx];
                _fill_color = row.labelColor || this.options.labelColor || '#000000'; // ADDED
                return this.setLabels(row.label, this.options.formatter(row.value, row), _fill_color); // ADDED parameter _fill_color
            };


            MyMorris.Donut.prototype.setLabels = function (label1, label2, fill_color) {
                var inner, maxHeightBottom, maxHeightTop, maxWidth, text1bbox, text1scale, text2bbox, text2scale;
                _default_fill = fill_color || '#000000'; // ADDED
                inner = (Math.min(this.el.width() / 2, this.el.height() / 2) - 10) * 2 / 3;
                maxWidth = 1.8 * inner;
                maxHeightTop = inner / 2;
                maxHeightBottom = inner / 3;
                this.text1.attr({
                    text: label1,
                    transform: '',
                    fill: fill_color // ADDED
                });
                text1bbox = this.text1.getBBox();
                text1scale = Math.min(maxWidth / text1bbox.width, maxHeightTop / text1bbox.height);
                this.text1.attr({
                    transform: "S" + text1scale + "," + text1scale + "," + (text1bbox.x + text1bbox.width / 2) + "," + (text1bbox.y + text1bbox.height)
                });
                this.text2.attr({
                    text: label2,
                    transform: '',
                    fill: fill_color // ADDED
                });
                text2bbox = this.text2.getBBox();
                text2scale = Math.min(maxWidth / text2bbox.width, maxHeightBottom / text2bbox.height);
                return this.text2.attr({
                    transform: "S" + text2scale + "," + text2scale + "," + (text2bbox.x + text2bbox.width / 2) + "," + text2bbox.y
                });
            };
        }).call(this);

        getMorris('donut', 'donut_chart');

        function getMorris(type, element) {
            if (type === 'donut') {
                var morris = Morris.Donut({
                    element: element,
                    data: [
                        {
                            label: 'Used %',
                            value: {{total_used_notification}},
                            labelColor: '#4c9f75'
                        }, {
                        label: 'Unused %',
                            value: {{remaining_notification}},
                            labelColor: '#4c9f75'
                        }, 
                    ],
                    labelColor: "#4c9f75",
                    colors: ['#4c9f75', '#cfd3d4']
                });
            }
        }
    </script>

    <!-- <script>
        var ctx = document.getElementById("myChart");
        // var numDataPoints = 20;
        var dataset = {{data|safe}}

        var data = {
        labels: {{labels|safe}},
        datasets: [{
            data: dataset,
            pointRadius: 0,
            pointHitRadius:1,
            pointHoverRadius:2,
            pointHoverBorderWidth:2,
            borderWidth: 2,
            borderColor: '#0897e4',
            backgroundColor: '#f4f7fa',
        }]
        };

        new Chart(ctx, {
        type: 'line',
        data: data,
        options: {
            tooltips: {
            enabled: true,
            },
            legend: {
            display: false,
            },
            pointDot: false,
            scales: {
            xAxes: [{
                display: false,
            }],
            yAxes: [{
                display: false,
            }],
            }
        }
        });

    </script> -->
    <!-- <script>
        var ctx = document.getElementById("myChart1");
        // var numDataPoints = 100;
        var dataset = {{data|safe}}

        var data = {
        labels: {{labels|safe}},
        datasets: [{
            data: dataset,
            pointRadius: 0,
            pointHitRadius:1,
            pointHoverRadius:2,
            pointHoverBorderWidth:2,
            borderWidth: 2,
            borderColor: '#0897e4',
            backgroundColor: '#f4f7fa',
        }]
        };

        new Chart(ctx, {
        type: 'line',
        data: data,
        options: {
            tooltips: {
            enabled: true,
            },
            legend: {
            display: false,
            },
            pointDot: false,
            scales: {
            xAxes: [{
                display: false,
            }],
            yAxes: [{
                display: false,
            }],
            }
        }
        });
    </script> -->
    <script>

        $('#submit').on('click', function(){
            var date = new Date($('#date-input').val());
            var day = date.getDate();
            var month = date.getMonth() + 1;
            var year = date.getFullYear();
            var date = String([year, month, day].join('-'));
            // $('#dates').val(d_date);
            // document.getElementById('dates').val(d_date);
            // alert(d_date);
        });
    </script>
    <script>
        $(document).ready(function() {
            $('#my-table').DataTable();
                responsive: true
        } );
    </script>
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.22/js/dataTables.bootstrap4.min.js"></script>
{% endblock javascripts %}
